<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ポ・トロクエスト オープニング</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --crawl-duration: 88s; }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: radial-gradient(circle at top, #111 0%, #000 55%, #000 100%);
      height: 100vh;
      overflow: hidden;
      font-family: "Yu Gothic", "Hiragino Sans", sans-serif;
      color: #ffe81f;
      letter-spacing: 0.08em;
    }
    /* 冒頭の一文：0〜3秒表示、3〜4秒で消える */
    .intro {
      position: absolute;
      top: 35%;
      width: 100%;
      text-align: center;
      font-size: 1.1rem;
      opacity: 0;
      animation: introFade 4s ease-out 0s forwards;
      z-index: 5;
    }
    @keyframes introFade {
      0%   { opacity: 0; }
      5%   { opacity: 1; }
      75%  { opacity: 1; }
      100% { opacity: 0; } /* ここでちょうど4秒 */
    }

    .star-wars {
      position: relative;
      height: 100vh;
      perspective: 400px;
      perspective-origin: 50% 100%;
    }

    /* ロール：初期は完全に見えない＆下にある */
    .crawl {
      position: absolute;
      bottom: -100vh;
      width: 80%;
      max-width: 720px;
      left: 50%;
      transform-origin: 50% 100%;
      font-size: 1.5rem;
      text-align: justify;
      line-height: 1.5;
      text-shadow: 0 0 8px rgba(0,0,0,0.8);
      opacity: 0; /* ←絶対に表示させない */
      pointer-events: none;
    }
    /* 再生するときだけアニメする */
    .crawl.play {
      animation: crawl var(--crawl-duration) linear forwards;
    }
    @keyframes crawl {
      0% {
        opacity: 1;  /* ここで初めて表示 */
        transform: translate(-50%, 20vh) rotateX(20deg);
      }
      100% {
        opacity: 1;
        transform: translate(-50%, -160vh) rotateX(28deg);
      }
    }

    .title-block { text-align: center; margin-bottom: 2.5rem; }
    .title-block .episode {
      font-size: 1rem;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      margin-bottom: 1rem;
    }
    .title-block h1 { font-size: 2.2rem; margin: 0; }

    .stars {
      position: fixed;
      inset: 0;
      background-image:
        radial-gradient(#fff 1px, transparent 1px),
        radial-gradient(#fff 1px, transparent 1px);
      background-size: 250px 250px, 320px 320px;
      background-position: 0 0, 80px 120px;
      opacity: 0.18;
      pointer-events: none;
      animation: starMove 45s linear infinite;
    }
    @keyframes starMove {
      from { transform: translateY(0); }
      to { transform: translateY(300px); }
    }

    /* SKIPボタン */
    #skip-opening {
      position: absolute;
      top: 1.2rem;
      right: 1.2rem;
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(255,232,31,0.7);
      color: #ffe81f;
      padding: 0.4rem 0.75rem;
      border-radius: 999px;
      font-size: 0.75rem;
      cursor: pointer;
      z-index: 10;
      backdrop-filter: blur(2px);
      transition: background .2s;
    }
    #skip-opening:hover {
      background: rgba(0,0,0,0.6);
    }

    /* クリック案内はもう使わない */
    .tap-to-start { display: none; }

    @media (max-width: 600px) {
      .crawl { font-size: 1.2rem; width: 90%; }
      .intro { font-size: 1rem; }
      .title-block h1 { font-size: 1.8rem; }
      #skip-opening { font-size: 0.7rem; top: .75rem; right: .75rem; }
    }
  </style>
</head>
<body>
  <div class="stars"></div>

  <button id="skip-opening" type="button">SKIP</button>

  <div class="intro">
    遥か未来、そしてどこにでもありそうな社会で――<br>
    人々は、残業と叱責に疲れ果てていた…。
  </div>

  <div class="star-wars" aria-label="オープニングストーリー">
    <div class="crawl" id="crawl">
      <div class="title-block">
        <div class="episode">EPISODE 1</div>
        <h1>ポ・トロクエスト</h1>
      </div>

      <p>時は20XX年。長らく封印されていた<strong>「社会の闇」</strong>が解き放たれ、世界は再び仕事の支配に飲み込まれた。</p>
      <p>終わりのない残業。届かない評価。叱責だけが空気のように漂い、人々は笑顔すら記憶の彼方へ失おうとしていた。</p>
      <p>希望は語られなくなり、終電はいつしか「日常」と呼ばれ、誰も「楽しさ」を口にしなくなった。</p>
      <p>だが、その混沌の只中――闇の裂け目から、ひとすじの光が生まれる。</p>
      <p>それは、古き良き「お給仕」の精神を受け継ぎ、ご主人様を笑顔に導くことを自らの使命とした一人の<strong>メイド</strong>であった。</p>
      <p>彼女は知っていた。叱責には癒やしを、残業にはご褒美を、荒んだ心にはときめきを――それが世界をもう一度あたたかくするただ一つの道であることを。</p>
      <p>こうして、社会の闇に立ち向かう小さくも眩しい反逆が始まる。その物語こそ――</p>
      <p style="text-align:center; margin-top:2.5rem; font-size:1.2em;">
        <strong>「ポ・トロクエスト」</strong><br>である。
      </p>
    </div>
  </div>

  <script>
    const crawl = document.getElementById('crawl');
    const skipBtn = document.getElementById('skip-opening');
    let finishTimer = null;

    function notifyFinish() {
      window.parent.postMessage({ type: "opening-finished" }, "*");
    }

    function startOpening() {
      // ★ ここが「冒頭が消えてからの待ち時間」
      // 4000ms（消えるまで）
      setTimeout(() => {
        crawl.classList.add('play');
      }, 4000);

      // ★ 自動でオープニング終了通知（お好みで変えてOK）
      finishTimer = setTimeout(() => {
        notifyFinish();
      }, 45000);
    }

    // SKIPで即終了
    skipBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      if (finishTimer) clearTimeout(finishTimer);
      notifyFinish();
    });

    // ページ表示と同時に開始
    startOpening();
  </script>
</body>
</html>
